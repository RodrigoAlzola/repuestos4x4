{% extends 'base.html' %}

{% block content %}
<!-- Header -->
<header class="bg-danger py-5">
  <div class="container px-4 px-lg-5 my-5">
    <div class="text-center text-white">
      <h1 class="display-4 fw-bolder">
        <i class="bi bi-x-circle-fill me-3"></i>Pago No Completado
      </h1>
      <p class="lead fw-normal mb-0">Tu orden no pudo ser procesada</p>
    </div>
  </div>
</header>
<br/>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      
      <!-- Mensaje según el tipo de fallo -->
      <div class="card mb-4 border-danger">
        <div class="card-body text-center py-5">
          
          {% if reason == 'cancelled' %}
            <i class="bi bi-x-octagon text-warning" style="font-size: 4rem;"></i>
            <h3 class="mt-3">Transacción Cancelada</h3>
            <p class="text-muted">{{ message }}</p>
          
          {% elif reason == 'rejected' %}
            <i class="bi bi-credit-card-2-back text-danger" style="font-size: 4rem;"></i>
            <h3 class="mt-3">Pago Rechazado</h3>
            <p class="text-muted">{{ message }}</p>
            {% if status %}
            <p class="text-muted"><small>Estado: {{ status }}</small></p>
            {% endif %}
          
          {% else %}
            <i class="bi bi-exclamation-triangle text-danger" style="font-size: 4rem;"></i>
            <h3 class="mt-3">Error en el Pago</h3>
            <p class="text-muted">{{ message|default:"Hubo un problema al procesar tu pago." }}</p>
          {% endif %}
          
        </div>
      </div>

      <!-- Qué hacer ahora -->
      <div class="card mb-4">
        <div class="card-header bg-info text-white">
          <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>¿Qué puedes hacer?</h5>
        </div>
        <div class="card-body">
          <ul class="mb-0">
            {% if reason == 'cancelled' %}
              <li>Volver al carrito y continuar con el proceso de pago</li>
              <li>Revisar los productos en tu carrito antes de pagar</li>
            {% elif reason == 'rejected' %}
              <li>Verificar que los datos de tu tarjeta sean correctos</li>
              <li>Asegurarte de tener fondos suficientes</li>
              <li>Intentar con otra tarjeta</li>
              <li>Contactar a tu banco si el problema persiste</li>
            {% else %}
              <li>Intentar el pago nuevamente</li>
              <li>Verificar tu conexión a internet</li>
              <li>Contactar con nuestro soporte si el problema continúa</li>
            {% endif %}
          </ul>
        </div>
      </div>

      <!-- Botones de acción -->
      <div class="text-center mb-5">
        <a href="{% url 'cart_summary' %}" class="btn btn-primary btn-lg me-2">
          <i class="bi bi-cart-fill me-2"></i>Volver al Carrito
        </a>
        <a href="{% url 'home' %}" class="btn btn-outline-secondary btn-lg">
          <i class="bi bi-house-fill me-2"></i>Ir al Inicio
        </a>
      </div>

      <!-- Info de contacto -->
      <div class="alert alert-light text-center">
        <p class="mb-0">
          <strong>¿Necesitas ayuda?</strong><br>
          Contáctanos en <a href="mailto:soporte@4x4max.cl">soporte@4x4max.cl</a>
        </p>
      </div>

    </div>
  </div>
</div>

<br/><br/>
{% endblock %}